<!doctype html>
<html lang="en" class="vf-no-js">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" media="all" href="/css/styles.css" />
    <title>Cutting down on Postfix spam relaying | All about Ken Hawkins</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/ken-favicon/assets/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/ken-favicon/assets/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/ken-favicon/assets/favicon-16x16.png">
<link rel="manifest" href="/assets/ken-favicon/assets/site.webmanifest">
<link rel="mask-icon" href="/assets/ken-favicon/assets/safari-pinned-tab.svg" color="#ffffff">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">

    <script>
// Detect if JS is on and swap vf-no-js for vf-js on the html element
(function(H){H.className=H.className.replace(/\bvf-no-js\b/,'vf-js')})(document.documentElement);
</script>

    <meta name="description" content="Hello. I am Ken Hawkins. Builder of websites, project planner, newspaper nerd, information architect, lover of UX, consultant. Information structure is my thing." />
    <meta name="MobileOptimized" content="width" />
    <meta name="HandheldFriendly" content="true" />
    <meta name="abstract" content="Hello. I am Ken Hawkins. Builder of websites, project planner, newspaper nerd, information architect, lover of UX, consultant. Information structure is my thing." />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="keywords" content="Drupal, web development, Ken Hawkins, UX, information architecture" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="All About Ken Hawkins" />
    <meta property="og:url" content="https://www.allaboutken.com/posts/20130321-postfix-spam.html" />
    <meta property="og:title" content="Cutting down on Postfix spam relaying > All About Ken Hawkins" />
    <meta property="og:image" content="https://www.allaboutken.com/images/crop-cinema/blog/mail-pile.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@khawkins98" />
    <meta name="twitter:site:id" content="3723201" />
    <meta name="twitter:creator" content="@khawkins98" />
    <meta name="twitter:creator:id" content="3723201" />
    <meta name="twitter:url" content="https://www.allaboutken.com/posts/20130321-postfix-spam.html" />
    <meta name="twitter:description" content="Postfix, it's used with many a LAMP stack to send out messages from a site, unfortunately it's prone to relaying many spam messages out of the box." />
    <meta name="twitter:image" content="https://www.allaboutken.com/images/crop-cinema/blog/mail-pile.jpg" />
    <meta name="dcterms.title" content="Cutting down on Postfix spam relaying > All About Ken Hawkins" />
    <meta name="dcterms.type" content="Text" />
    <meta name="dcterms.identifier" content="https://allaboutken.com/posts/20130321-postfix-spam.html" />
    <meta name="dcterms.format" content="text/html" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.allaboutken.com/rss.xml">
  </head>
  <body class="vf-body vf-stack vf-stack--400">
    <header class="vf-global-header" role="banner">
      <a href="/" class="vf-logo"><span class="vf-logo__text">AllAboutKen.com</span></a>
      <nav class="vf-navigation vf-navigation--global | vf-cluster | show-for-medium | do-not-print">
        <ul class="vf-navigation__list | vf-list--inline">
          <li class="vf-navigation__item">
            <a href="/blog" class="vf-navigation__link">Blog</a>
          </li>
          <li class="vf-navigation__item | show-for-medium-only">
            <a href="mailto:khawkins98@gmail.com" class="vf-navigation__link">E-mail</a>
          </li>
          <li class="vf-navigation__item | show-for-large">
            <a href="mailto:khawkins98@gmail.com" class="vf-navigation__link">khawkins98@gmail.com</a>
          </li>
          <li class="vf-navigation__item">
            <a href="https://twitter.com/khawkins98" class="vf-navigation__link">Twitter<span class="show-for-large"> @khawkins98</span></a>
          </li>
          <li class="vf-navigation__item">
            <a href="https://www.linkedin.com/in/allaboutken" class="vf-navigation__link">LinkedIn</a>
          </li>
        </ul>
      </nav>
    </header>
    <main role="main">
    
<article class="vf-grid vf-grid__col-3">
  <div class="vf-grid__col--span-1">
    <section class="vf-u-fullbleed vf-u-background-color--yellow--dark">
      <h1 class="vf-text-heading--1 vf-font-now-alt vf-font-now-alt--display | kh-post-title">Cutting down on Postfix spam relaying</h1>
    </section>
    <p><time datetime="Thu Mar 21 2013 00:00:00 GMT+0000 (Coordinated Universal Time)" class="vf-summary__date">21 Mar 2013</time> </p>
  </div>
  <div class="vf-grid__col--span-2 vf-content">
    <figure

class="vf-figure">
  <img class="vf-figure__image" src="/images/crop-cinema/blog/mail-pile.jpg" alt="">
  <figcaption class="vf-figure__caption">Image credit: <a href="https://www.flickr.com/photos/cogdog/2925889614">Flickr user "Alan Levine"</a></figcaption>
</figure>
    <section class="vf-grid vf-grid__col-3">
      <div class="vf-grid__col--span-2">
        <p class="vf-text-body--1">Postfix, it's used with many a LAMP stack to send out messages from a site, unfortunately it's prone to relaying many spam messages out of the box.</p>

        
<p>The below code can be easily appended to Postfix's main.cf to drastically reduce the authorization hole.</p>
<p>On Ubuntu you'll find the file at <code>/etc/postfix/main.cf</code> </p>
<code>smtpd_helo_required     = yes<br>
strict_rfc821_envelopes = yes<br>
disable_vrfy_command = yes<br>
unknown_address_reject_code  = 554<br>
unknown_hostname_reject_code = 554<br>
unknown_client_reject_code   = 554<br>
smtpd_helo_restrictions = permit_mynetworks, reject_invalid_hostname, permit<br>
smtpd_recipient_restrictions =<br>
 check_client_access hash:/etc/postfix/helo_client_exceptions<br>
 check_sender_access    hash:/etc/postfix/sender_checks,<br>
 reject_invalid_hostname,<br>
 reject_non_fqdn_hostname,<br>
 reject_non_fqdn_sender,<br>
 reject_non_fqdn_recipient,<br>
 reject_unknown_sender_domain,<br>
 reject_unknown_recipient_domain,<br>
 permit_mynetworks,<br>
 reject_unauth_destination,<br>
 reject_rbl_client cbl.abuseat.org,<br>
 reject_rbl_client sbl-xbl.spamhaus.org,<br>
 reject_rbl_client bl.spamcop.net,<br>
 reject_rhsbl_sender    dsn.rfc-ignorant.org,<br>
 permit<br></code>
<p>Then restart postfix: <code>/etc/init.d/postfix restart</code></p>
<p>A couple of other handy commands:</p>
<p>- Check the mail queue with <code>mailq</code><br>
- Empty the queue with <code>postsuper -d ALL</code></p>


      </div>
      <div class="vf-grid__col--span-1">
      </div>
    </section>
  </div>
</article>

<div class="vf-stack vf-u-padding__top--800">

  <article class="vf-grid vf-grid__col-3 | do-not-print">
    <div class="vf-grid__col--span-1">
      <h2 class="vf-text-heading--2 | vf-u-float__right--md">Comment?</h2>
    </div>
    <div class="vf-grid__col--span-2 vf-content">
      <p>Thanks for reading, if you have comment I'd love to hear it.</p>

      <p>
        <a href="https://twitter.com/khawkins98">Twitter<span class="show-for-large"> @khawkins98</span></a>
        
        &nbsp; <a href="https://www.linkedin.com/in/allaboutken">LinkedIn</a>
        
        &nbsp; <a href="mailto:khawkins98@gmail.com">khawkins98@gmail.com</a>
      </p>
    </div>
  </article>
  


  
  <article class="vf-grid vf-grid__col-3 | do-not-print">
    <div class="vf-grid__col--span-1">
      <h2 class="vf-text-heading--2 | vf-u-float__right--md">Read more</h2>
    </div>
    <div class="vf-grid__col--span-2 vf-content">
      
      

      

      
      <p class="vf-text-body--3">Next: <a href="." class="vf-link">Muliple IPs on an Ubuntu EC2 VPC? Yes, please!</a></p>
      

      <p>
        <a href="/blog" class="vf-button vf-button--secondary vf-button--sm"> â‡¤ Blog index</a>
      </p>
    </div>
  </article>
  
</div>
    </main>
    
      <footer class="vf-footer | do-not-print" role="contentinfo">
  <div class="vf-footer__inner">
    <div class="vf-footer__notice">

      <div class="vf-body--text | vf-content | do-not-print"><p><strong>I'm Ken Hawkins</strong>
I bring structure and process to complex web projects. Learn more about me <a class="vf-footer__link" href="/">on the front page</a> or <a class="vf-footer__link" href="/#hello">get in touch</a>.</p>
</div>

      <a class="vf-footer__link" href="/posts/20200713-moving-from-panini-to-eleventy/">About this site's technology</a>
      &nbsp; <a class="vf-footer__link" href="/privacy">Curious about privacy?</a></div>
  </div>
</footer>

<code class="show-for-print-only small">Printed direct from AllAboutKen.com</code>

    
    
    <script src="/scripts/scripts.js"></script>
  </body>
</html>
